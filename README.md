# Демо-версия Битрикс24

Этот проект позволяет быстро развернуть демо-версию портала Битрикс24 для тестирования и разработки.

## Требования

- Docker
- Docker Compose
- Минимум 4GB RAM
- Минимум 10GB свободного места на диске

## Быстрый старт

1. **Клонируйте репозиторий:**
   ```bash
   git clone <your-repo-url>
   cd test
   ```

2. **Запустите сервисы:**
   ```bash
   docker-compose up -d
   ```

3. **Дождитесь запуска (может занять 2-3 минуты):**
   ```bash
   docker-compose logs -f web
   ```

4. **Откройте в браузере:**
   ```
   http://localhost:8080
   ```

5. **PHP скрипт нормализации:**
   ```
   http://localhost:8080/normalize_users.php
   ```

## Настройка

### Демонстрация PHP скрипта

1. **PHP Info:** Откройте `http://localhost:8080/info.php` для проверки PHP
2. **Скрипт нормализации:** Откройте `http://localhost:8080/normalize_users.php`
3. **Тестирование:** Введите URL вебхука для тестирования API

### Доступ к базе данных

- **Хост:** localhost
- **Порт:** 3306
- **База данных:** bitrix24
- **Пользователь:** bitrix24
- **Пароль:** bitrix24_password

## Управление

### Остановка сервисов
```bash
docker-compose down
```

### Перезапуск
```bash
docker-compose restart
```

### Просмотр логов
```bash
docker-compose logs web
docker-compose logs mysql
```

### Очистка данных
```bash
docker-compose down -v
```

## Структура проекта

```
test/
├── docker-compose.yml    # Конфигурация Docker
├── README.md            # Документация
└── scripts/             # Скрипты для работы с данными
    ├── normalize_users.php      # PHP скрипт нормализации
    ├── index.php                # Главная страница
    ├── info.php                 # PHP info
    └── php_requirements.md     # Требования для PHP
```

## Решение задачи нормализации данных

В папке `scripts/` находится PHP скрипт для решения задачи нормализации записей сотрудников в Битрикс24:

### PHP скрипт (normalize_users.php)

**Преимущества PHP версии:**
- ✅ Встроенный веб-интерфейс
- ✅ Не требует установки дополнительных библиотек
- ✅ Работает как веб-скрипт и консольное приложение
- ✅ Проще в развертывании

#### Веб-интерфейс:
1. Откройте в браузере: **http://localhost:8080/normalize_users.php**
2. Введите URL вебхука и нажмите "Запустить нормализацию"

#### Консольный режим:
```bash
php scripts/normalize_users.php --webhook=https://your-domain.bitrix24.ru/rest/1/key/
```

## Полезные команды

### Проверка статуса сервисов
```bash
docker-compose ps
```

### Подключение к контейнеру веб-сервера
```bash
docker exec -it bitrix24_demo bash
```

### Подключение к MySQL
```bash
docker exec -it bitrix24_mysql mysql -u bitrix24 -p bitrix24
```

## Устранение неполадок

### Проблемы с памятью
Если контейнеры не запускаются из-за нехватки памяти:
1. Увеличьте лимит памяти в Docker Desktop
2. Перезапустите Docker

### Проблемы с портами
Если порт 8080 занят, измените в `docker-compose.yml`:
```yaml
ports:
  - "8081:80"  # Используйте другой порт
```

### Медленная работа
- Убедитесь, что у вас достаточно RAM (минимум 4GB)
- Проверьте, что Docker использует SSD диск
- Закройте другие ресурсоемкие приложения

## Лицензия

Этот проект предназначен только для демонстрационных и образовательных целей.
